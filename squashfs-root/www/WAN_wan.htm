<html>
<head>
<%10%>
<title>NETGEAR Router <%11%></title> 
<link rel="stylesheet" href="form.css">
<STYLE TYPE="text/javascript">
	classes.num.all.fontFamily = "Courier";
	classes.num.all.fontSize = "10pt" ;
</style>
<%28%>
<script language="javascript" type="text/javascript">
<!--
function check_data()
{
	var cf = document.forms[0];
	var msg = "";
	if (cf.dmz_enable.checked)
	{
		if(checkIP(cf.dmzip1,cf.dmzip2,cf.dmzip3,cf.dmzip4,254)
			|| (parseInt(cf.dmzip4.value,10) == 0))
			msg += "<%883%>\n";
	}
	msg+= checkInt(cf.wan_mtu, "MTU value", 1, parseInt(cf.wan_way.value,10), true);

	if((parseInt(cf.wan_mtu.value,10)>parseInt(cf.wan_way.value,10))
			||(parseInt(cf.wan_mtu.value,10)<616))
		msg += "<%884%> "+cf.wan_way.value+"\n"; 

	if (msg.length > 1)
	{
		alert(msg);
		return false;
	}
	cf.dmzip1.value = parseInt(cf.dmzip1.value,10);
	cf.dmzip2.value = parseInt(cf.dmzip2.value,10);
	cf.dmzip3.value = parseInt(cf.dmzip3.value,10);
	cf.dmzip4.value = parseInt(cf.dmzip4.value,10);
	cf.dmz_ip.value = cf.dmzip1.value+'.'+cf.dmzip2.value+'.'+cf.dmzip3.value+'.'+cf.dmzip4.value;
	cf.wan_mtu.value = parseInt(cf.wan_mtu.value,10);
	return true;
}

function loadSettings()
{
	var cf = document.forms[0];
	var spiEnable = "<%885%>";
	var dmzEnable = "<%886%>";
	var resp2ping = "<%887%>";
	var nat_inbound_filtering = cf.nat_inbound_filtering.value;
	var sipenable = "<%888%>";
<%889%>
	var gproxy_enable = "<%890%>";
<%891%>
<%113%>
	var ipv6_enable = "<%892%>";
<%114%>

	if (nat_inbound_filtering == "1")
		cf.NatInboundFiltering[0].checked = true;
	else
		cf.NatInboundFiltering[1].checked = true;

	if (spiEnable == "1")
		cf.disable_spi.checked = false;
	else
		cf.disable_spi.checked = true;

	var dmzIP = cf.dmz_ip.value.split(".");
	cf.dmzip1.value = dmzIP[0];
	cf.dmzip2.value = dmzIP[1];
	cf.dmzip3.value = dmzIP[2];
	cf.dmzip4.value = dmzIP[3];

	if (dmzEnable == "1")
	{
		cf.dmz_enable.checked = true;
	}
	else
	{
		cf.dmz_enable.checked = false;
	}

	if (resp2ping == "1")
		cf.rspToPing.checked = true;
	else
		cf.rspToPing.checked = false;

	if (sipenable == "1")
		cf.disable_sip.checked = false;
	else
		cf.disable_sip.checked = true;
<%889%>
	if (gproxy_enable == "1")
		cf.disable_gproxy.checked = false;
	else
		cf.disable_gproxy.checked = true;
<%891%>
<%113%>
	if (ipv6_enable == "1")
		cf.ipv6disable.checked = false;
	else
		cf.ipv6disable.checked = true;
    if (cf.wan_proto.value == "pppoe")
        cf.wan_way.value = 1454;
    else if (cf.wan_proto.value == "pptp" || cf.wan_proto.value == "l2tp")
        cf.wan_way.value = 1460;
    else
<%114%>

    if (cf.wan_proto.value == "pppoe")
        cf.wan_way.value = 1492;
    else if (cf.wan_proto.value == "pptp" || cf.wan_proto.value == "l2tp")
        cf.wan_way.value = 1436;
    else
        cf.wan_way.value = 1500;

    if (parseInt(cf.nvram_mtu.value,10) >= parseInt(cf.wan_way.value,10) )
        cf.wan_mtu.value = cf.wan_way.value;
    else
        cf.wan_mtu.value = cf.nvram_mtu.value;
}

//-->
</script> 
</head>
<body bgcolor="#ffffff" onload="loadSettings();loadhelp('WAN_wan');document.forms[0].elements[0].focus();">
<form name="frmRules" method="POST" action="security.cgi">
<table border="0" cellpadding="0" cellspacing="3" width="100%">
<tr>
	<td colspan="2"><h1><%560%></h1></td>
</tr>

<tr> <!-- RULE -->
 <td colspan="2" background="liteblue.gif" height="12"> &nbsp;</td>
</tr>

<tr>
 <td colspan="2"><input type="checkbox"  name="disable_spi" value="disable_spi"><a href="javascript:loadhelp('WAN_wan','spi')" tabindex="-1"> <b><%893%></b></a></td>
</tr>

<tr> <!-- RULE -->
 <td colspan="2" background="liteblue.gif" height="12"> &nbsp;</td>
</tr>


<tr>
	<td nowrap align="left" width="50%"><input type="checkbox"  name="dmz_enable" value="dmz_enable">
	<a href="javascript:loadhelp('WAN_wan','dmz')" tabindex="-1"><b><%894%></b></a></td>
<td nowrap align="right"><span class="num"><input type="text" name="dmzip1" class="num" size="4" maxlength="3">.<input type="text" name="dmzip2" class="num" size="4" maxlength="3">.<input type="text" name="dmzip3" class="num" size="4" maxlength="3">.<input type="text" name="dmzip4" class="num" size="4" maxlength="3"></span></td>
</tr>

<tr> <!-- RULE -->
 <td colspan="2" background="liteblue.gif" height="12"> &nbsp;</td>
</tr>


<tr>
<td colspan="2"><input type="checkbox" name="rspToPing" value="rspToPing"><a href="javascript:loadhelp('WAN_wan','ping')" tabindex="-1"> <b><%895%></b></a></td>
</tr>

<tr> <!-- RULE -->
 <td colspan="2" background="liteblue.gif" height="12"> &nbsp;</td>
</tr>

<%171%>
<tr>
<td colspan="2"><input type="checkbox" name="disable_gproxy" value="disable_gproxy"><a href="javascript:loadhelp('WAN_wan','gproxy')" tabindex="-1"> <b><%896%></b></a></td>
</tr>

<tr>
 <td colspan="2" background="liteblue.gif" height="12"> &nbsp;</td>
</tr>
<%173%>
<%124%>

<tr>
<td colspan="2"><input type="checkbox" name="ipv6disable" value="ipv6disable"><a href="javascript:loadhelp('WAN_wan','ipv6')"> <b><%897%></b></a></td>
</tr>

<tr>
 <td colspan="2" background="liteblue.gif" height="12"> &nbsp;</td>
</tr>

<%126%>
<tr>
	<td>&nbsp;<a href="javascript:loadhelp('WAN_wan','mtu')" tabindex="-1"><b><%898%></b><%899%></a></td>
	<td align="right" class="num"><input type="text" name="wan_mtu" size="5" maxlength="4"></td>
</tr>


<tr> <!-- RULE -->
 <td colspan="2" background="liteblue.gif" height="12"> &nbsp;</td>
</tr>

<tr>
	<td>&nbsp;<a href="javascript:loadhelp('WAN_wan','nat')" tabindex="-1"><b><%900%></b></a></td>
	<td align="right">
	    <input type="radio" name="NatInboundFiltering" value="Secured"><%901%>
	    <input type="radio" name="NatInboundFiltering" value="Open"><%902%>
    </td>
</tr>

<tr> <!-- RULE -->
    <td colspan="2"><input type="checkbox" name="disable_sip" value="disable_sip"><a href="javascript:loadhelp('WAN_wan','sipalg')" tabindex="-1"> <b><%903%></b></a></td>
</tr>

<tr> <!-- RULE -->
 <td colspan="2" background="liteblue.gif" height="12"> &nbsp;</td>
</tr>

<tr>
 <td colspan="2" align="center">
 <input type="submit" name="apply" value="<%93%>" onClick="return check_data()">
 <input type="button" name="cancel" value="<%94%>" onclick="loadSettings();"></td>
</tr>
<tr>
 <input type="hidden" name="wan_way" value="1500">
 <INPUT name="nat_inbound_filtering" type=hidden value= "<%904%>">
 <input type="hidden" name="wan_proto" value= "<%47%>">
 <input type="hidden" name="nvram_mtu" value= "<%905%>">
 <INPUT name="dmz_ip" type=hidden value= "<%906%>">
</tr>
</table>

</form>
</body>
</html>


