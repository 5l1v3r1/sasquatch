<html>
<head>
<%10%>
<title>NETGEAR Router <%11%></title>
<link rel="stylesheet" href="form.css">
<STYLE TYPE="text/javascript">
	classes.num.all.fontFamily = "Courier";
	classes.num.all.fontSize = "10pt" ;
</style>
<%28%>
<script language="javascript" type="text/javascript">
<!-- 
var DisableFixedDNS = false;
var DisableFixedMAC = false;
var MacAddress;
var DodDisable = false;

function goTestApply()
{
	var winoptions = "width=640,height=480,menubar=yes,toolbar=yes,status=yes,location=yes,resizable=yes";
	if(document.forms[0].runtest.value == "yes")
		window.open('BAS_wtest_l.htm','test_win',winoptions);
}

function loadcheck()
{
	var cf = document.forms[0];
	if(isIE()){
		cf.pptp_username.size="24";
		cf.pptp_passwd.size="24";
	}
	loadhelp('WIZ_pptp');
}

function loadhelp(fname,anchname) 
{
    if (top.helpframe != null)
    {
        if ((loadhelp.arguments.length == 1 ) || (anchname == "" ))
        	top.helpframe.location.href=fname+"_h.htm";
        else
        	top.helpframe.location.href=fname+"_h.htm#" + anchname;
    }
}        

function loadSettings()
{
	var cf = document.forms[0];
	var pptp_user_ip = cf.pptp_user_ip.value.split(".");
	var pptp_gateway = cf.pptp_gateway.value.split(".");

	if ( (cf.pptp_user_ip.value == "...") || (cf.pptp_user_ip.value == "") )
	{
	    setDisabled(true, cf.mygw_1, cf.mygw_2, cf.mygw_3, cf.mygw_4);
	}
	if (cf.pptp_user_ip.value != "")
	{
		cf.myip_1.value = pptp_user_ip[0];
		cf.myip_2.value = pptp_user_ip[1];
		cf.myip_3.value = pptp_user_ip[2];
		cf.myip_4.value = pptp_user_ip[3];
	}
	
	if (cf.pptp_gateway.value != "")
	{
		cf.mygw_1.value = pptp_gateway[0];
		cf.mygw_2.value = pptp_gateway[1];
		cf.mygw_3.value = pptp_gateway[2];
		cf.mygw_4.value = pptp_gateway[3];
	}
}

function checkData(index)
{
	var cf = document.forms[0];
	var msg = "";
	var region_gui = cf.gui_region.value;
	
	msg+= checkBlank(cf.pptp_username, "<%117%>");
	if(cf.pptp_idletime.value.length<=0)
		msg+= "<%115%>";
	else if(!_isNumeric(cf.pptp_idletime.value))
		msg+= "<%116%>";
	
	if((cf.myip_1.value.length>0)||(cf.myip_2.value.length>0)||(cf.myip_3.value.length>0)||(cf.myip_4.value.length>0))
	{
		if(checkIP(cf.myip_1,cf.myip_2,cf.myip_3,cf.myip_4,254)||(parseInt(cf.myip_4.value,10)==0))
			msg+= "<%153%>";
		else if (region_gui == "Russian")
	    {
	        if (checkIPMatchWithNetmask(cf.mymask_1,cf.mymask_2,cf.mymask_3,cf.mymask_4,cf.myip_1,cf.myip_2,cf.myip_3,cf.myip_4))
	            msg+= "<%153%>";
	        if(checkIP(cf.mymask_1,cf.mymask_2,cf.mymask_3,cf.mymask_4,255))
		        msg += "<%67%>";
	    }
		else
		{
			cf.myip_1.value = parseInt(cf.myip_1.value,10);
			cf.myip_2.value = parseInt(cf.myip_2.value,10);
			cf.myip_3.value = parseInt(cf.myip_3.value,10);
			cf.myip_4.value = parseInt(cf.myip_4.value,10);
		}
		cf.static_pptp_enable.value = 1;
	}
	else
		cf.static_pptp_enable.value = 0;

	if((cf.mygw_1.value.length>0)||(cf.mygw_2.value.length>0)||(cf.mygw_3.value.length>0)||(cf.mygw_4.value.length>0))
	{
		if(checkIP(cf.mygw_1,cf.mygw_2,cf.mygw_3,cf.mygw_4,254)||(parseInt(cf.mygw_4.value,10)==0))
		    msg+= "<%68%>";
		else
		{
			cf.mygw_1.value = parseInt(cf.mygw_1.value,10);
			cf.mygw_2.value = parseInt(cf.mygw_2.value,10);
			cf.mygw_3.value = parseInt(cf.mygw_3.value,10);
			cf.mygw_4.value = parseInt(cf.mygw_4.value,10);
		}
	}

	var data;
	data = cf.pptp_serv_ip.value.match(/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/);
	if ((data && !isValidIPaddr(cf.pptp_serv_ip.value))
		|| cf.pptp_serv_ip.value == ""
		|| cf.pptp_serv_ip.value.match( /[^\x20-\x7E]/ ))
		msg+= "<%154%>";

	if (msg.length > 1)
	{
		alert(msg);
		return false;
	}

	cf.pptp_user_ip.value = cf.myip_1.value+'.'+cf.myip_2.value+'.'+cf.myip_3.value+'.'+cf.myip_4.value;
	cf.pptp_gateway.value = cf.mygw_1.value+'.'+cf.mygw_2.value+'.'+cf.mygw_3.value+'.'+cf.mygw_4.value;
    if (region_gui == "Russian")
        cf.pptp_user_netmask.value = cf.mymask_1.value+'.'+cf.mymask_2.value+'.'+cf.mymask_3.value+'.'+cf.mymask_4.value;
    
    if (index == 1)
        cf.action.value = "apply";
    else if (index == 2)
        cf.action.value = "test";
    document.forms[0].submit();
	return true;
}

function myip_update()
{
    var cf = document.forms[0];

    if((cf.myip_1.value.length>0)&&(cf.myip_2.value.length>0)&&(cf.myip_3.value.length>0)&&(cf.myip_4.value.length>0))
    {
        setDisabled(false, cf.mygw_1, cf.mygw_2, cf.mygw_3, cf.mygw_4);
    }
    else
    {
        setDisabled(true, cf.mygw_1, cf.mygw_2, cf.mygw_3, cf.mygw_4);
    } 
}
//-->
</script>
</head>

<body bgcolor="#ffffff" onload="loadSettings();loadcheck();document.forms[0].elements[0].focus();goTestApply();">
<%95%>
<form name="formname" method="POST" action="wiz_pptp.cgi"> 
<%97%>
<%913%>
<form name="formname" method="POST" action="bsw_pptp.cgi"> 
<%914%>
<table border="0" cellpadding="0" cellspacing="3" width="99%">
<tr>
	<td colspan="2"><h1><%122%></h1></td>
</tr>

<tr>
	<td colspan="2" background="liteblue.gif" height="12"></td>
</tr>

<tr>
	<td><a href="javascript:loadhelp('WIZ_pptp','login')" tabindex="-1"><b><%127%></b></a></td>
	<td align="right"><input type="text" name="pptp_username" size="15" maxlength="60" value="<%155%>"></td>
</tr>
<tr>
	<td><a href="javascript:loadhelp('WIZ_pptp','password')" tabindex="-1"><b><%129%></b></a></td>
	<td align="right"><input type="password" name="pptp_passwd" size="15" maxlength="50" value="<%156%>"></td>
</tr>
<tr>
	<td nowrap><a href="javascript:loadhelp('WIZ_pptp','idletime')" tabindex="-1"><%137%></a></td>
	<td align="right"><input type="text" class="num" name="pptp_idletime" size="3" maxlength="3" value="<%157%>"></td>
</tr>

<tr> <!-- RULE -->
 <td colspan="2" background="liteblue.gif" height="12"></td>
</tr>

<tr>
 <TD NOWRAP><a href="javascript:loadhelp('WIZ_pptp','myip')" tabindex="-1"><b><%158%></b></a></td>
 <TD NOWRAP align="right" class="num"><input type="text" name="myip_1" class="num" size="4" maxlength="3" onChange="myip_update()">.<input type="text" name="myip_2" class="num" size="4" maxlength="3" onChange="myip_update()">.<input type="text" name="myip_3" class="num" size="4" maxlength="3" onChange="myip_update()">.<input type="text" name="myip_4" class="num" size="4" maxlength="3" onChange="myip_update()"></td>
</tr>

<%138%>
<tr>
	<td nowrap><b><%139%></b></td>
	<td align="right" class="num">
	<input type="text" name="mymask_1" class="num" size="4" maxlength="3">.<input type="text" name="mymask_2" class="num" size="4" maxlength="3">.<input type="text" name="mymask_3" class="num" size="4" maxlength="3">.<input type="text" name="mymask_4" class="num" size="4" maxlength="3"></td>
</tr>
<%140%>

<tr>
 <TD NOWRAP><a href="javascript:loadhelp('WIZ_pptp','serverip')" tabindex="-1"><b><%159%></b></a></td>
 <td align="right"><input type="text" name="pptp_serv_ip" size="24" maxlength="63" value="<%164%>"></td>
</tr>

<tr>
 <td><a href="javascript:loadhelp('BAS_pptp','gwip')" tabindex="-1"><b><%160%></b></a></td>
 <td align="right" class="num"><input type="text" name="mygw_1" class="num" size="4" maxlength="3">.<input type="text" name="mygw_2" class="num" size="4" maxlength="3">.<input type="text" name="mygw_3" class="num" size="4" maxlength="3">.<input type="text" name="mygw_4" class="num" size="4" maxlength="3"></td>
</tr>

<tr> <!-- RULE -->
 <td colspan="2" background="liteblue.gif" height="12"></td>
</tr>
<tr>
	<td colspan="2" align="center" nowrap><div ID="buttons" onmouseover="loadhelp('WIZ_pptp','buttons')">
<%95%>
	<input type="BUTTON" name="apply" value="<%93%>" onClick="checkData(1)">
	<input type="BUTTON" name="Cancel" value="<%94%>" onClick="reset();loadSettings();">
	<input type="BUTTON" name="Test" value="<%96%>" onClick="checkData(2)">
<%97%>
<%913%>
	<input type="SUBMIT" name="Next" value=" <%912%> " onClick="return checkData()">
<%914%>
</div></td></tr>
</table>
<input type="hidden" name="runtest" value="no">
<INPUT name=pptp_user_ip type=hidden value= "<%163%>">
<INPUT name=pptp_gateway type=hidden value="<%165%>">
<INPUT name=pptp_user_netmask type=hidden value="<%166%>">
<INPUT name=static_pptp_enable type=hidden value= "<%167%>">
<INPUT name=gui_region type=hidden value="<%149%>">
<INPUT name=action type=hidden value="">
</form>
<p></p>
</body>

</html>
